{"number":91,"title":"add validation to inputs","body":"","state":"open","updated_at":"2022-12-13T11:09:46Z","created_at":"2022-12-13T11:09:46Z","creator_user_login":"franc17"}
{"number":81,"title":"Add dev resources","body":"","state":"open","updated_at":"2022-11-24T21:03:49Z","created_at":"2022-07-06T10:11:43Z","creator_user_login":"armincerf"}
{"number":50,"title":"nmap scan causes null pointer exception","body":"Site Commit Hash: a696e48c36e29e0225088e0c7de0358e1fa36a35\r\n\r\nExecuting the following:\r\n```bash\r\nnmap -A -v -v localhost\r\n```\r\non a Linux machine running site-server causes a null pointer exception.\r\n\r\nSee the attached log file [site-server.log](https://github.com/juxt/site/files/7953005/site-server.log).\r\n\r\nSteps to reproduce:\r\n\r\n1. Start a clean site instance by following the steps in README.adoc (i.e., bin/site-server).\r\n2. Execute nmap command, and wait for a short period of time.","state":"open","updated_at":"2022-09-06T14:58:41Z","created_at":"2022-01-27T18:40:59Z","creator_user_login":"pwhittin"}
{"number":37,"title":"Handling of unaccepted/wrong content-type","body":"Currently specifying a bad `content-type` results in a server error. We could do two things to improve the dev experience:\r\n\r\n- Return a `406 Not Acceptable` instead of a server error.\r\n- Include the error and irritating content-type in the response.\r\n\r\nThe same is probably true for `content-language` and `content-encoding`.","state":"open","updated_at":"2022-01-11T17:40:04Z","created_at":"2021-12-16T16:25:44Z","creator_user_login":"FiV0"}
{"number":21,"title":"401 Unauthorized when trying to get admin token","body":"Following the Test drive I get the following when trying to get-token for the admin user\r\n\r\n```\r\nsite > bin/site get-token -u admin\r\nsite: Unix pass prefix: site/local/\r\nsite: Get token from http://localhost:2021/_site/token\r\nsite: Server response: 401 Unauthorized\r\n\r\nsite: Are your credentials valid? request-id is http://localhost:2021/_site/requests/50ba7d0fad679394de1aff2c\r\n```\r\n\r\nLooking at the log output it looks like the username being passed to juxt.pass.alpha.authentication/lookup-user is nil\r\n\r\n```\r\n17:16:43.457 [qtp1821409160-23] DEBUG juxt.site.alpha.handler - Resource provider: :juxt.site.alpha.handler/db\r\n17:16:43.461 [qtp1821409160-23] ERROR juxt.pass.alpha.authentication - #error {\r\n :cause nil\r\n :via\r\n [{:type java.lang.NullPointerException\r\n   :message nil\r\n   :at [java.util.regex.Matcher getTextLength Matcher.java 1770]}]\r\n :trace\r\n [[java.util.regex.Matcher getTextLength Matcher.java 1770]\r\n  [java.util.regex.Matcher reset Matcher.java 416]\r\n  [java.util.regex.Matcher <init> Matcher.java 253]\r\n  [java.util.regex.Pattern matcher Pattern.java 1133]\r\n  [clojure.core$re_matcher invokeStatic core.clj 4856]\r\n  [clojure.core$re_matches invokeStatic core.clj 4886]\r\n  [clojure.core$re_matches invoke core.clj 4886]\r\n  [juxt.pass.alpha.authentication$lookup_user invokeStatic authentication.clj 105]\r\n  [juxt.pass.alpha.authentication$lookup_user invoke authentication.clj 101]\r\n  [juxt.pass.alpha.authentication$authenticate invokeStatic authentication.clj 263]\r\n  [juxt.pass.alpha.authentication$authenticate invoke authentication.clj 227]\r\n  [juxt.site.alpha.handler$wrap_authenticate$fn__16783 invoke handler.clj 800]\r\n  [juxt.site.alpha.handler$wrap_negotiate_representation$fn__16778 invoke handler.clj 792]\r\n  [juxt.site.alpha.handler$wrap_find_current_representations$fn__16773 invoke handler.clj 787]\r\n  [juxt.site.alpha.handler$wrap_redirect$fn__16767 invoke handler.clj 773]\r\n  [juxt.site.alpha.handler$wrap_locate_resource$fn__16762 invoke handler.clj 760]\r\n  [juxt.site.alpha.handler$wrap_method_not_implemented_QMARK_$fn__16758 invoke handler.clj 754]\r\n  [juxt.site.alpha.handler$wrap_error_handling$fn__16923 invoke handler.clj 1240]\r\n  [juxt.site.alpha.handler$wrap_security_headers$fn__16828 invoke handler.clj 920]\r\n  [juxt.site.alpha.handler$wrap_cors_headers$fn__16874 invoke handler.clj 1029]\r\n  [juxt.site.alpha.handler$wrap_store_request_in_request_cache$fn__16965 invoke handler.clj 1380]\r\n  [juxt.site.alpha.handler$wrap_store_request$fn__16969 invoke handler.clj 1387]\r\n  [juxt.site.alpha.handler$wrap_log_request$fn__16975 invoke handler.clj 1405]\r\n  [juxt.site.alpha.handler$wrap_service_unavailable_QMARK_$fn__16983 invoke handler.clj 1428]\r\n  [juxt.site.alpha.handler$wrap_initialize_request$fn__16951 invoke handler.clj 1342]\r\n  [juxt.site.alpha.handler$wrap_healthcheck$fn__16979 invoke handler.clj 1412]\r\n  [juxt.site.alpha.handler$wrap_ring_1_adapter$fn__16959 invoke handler.clj 1369]\r\n  [ring.adapter.jetty$proxy_handler$fn__8527 invoke jetty.clj 27]\r\n  [ring.adapter.jetty.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a handle nil -1]\r\n  [org.eclipse.jetty.server.handler.HandlerWrapper handle HandlerWrapper.java 127]\r\n  [org.eclipse.jetty.server.Server handle Server.java 516]\r\n  [org.eclipse.jetty.server.HttpChannel lambda$handle$1 HttpChannel.java 388]\r\n  [org.eclipse.jetty.server.HttpChannel dispatch HttpChannel.java 633]\r\n  [org.eclipse.jetty.server.HttpChannel handle HttpChannel.java 380]\r\n  [org.eclipse.jetty.server.HttpConnection onFillable HttpConnection.java 273]\r\n  [org.eclipse.jetty.io.AbstractConnection$ReadCallback succeeded AbstractConnection.java 311]\r\n  [org.eclipse.jetty.io.FillInterest fillable FillInterest.java 105]\r\n  [org.eclipse.jetty.io.ChannelEndPoint$1 run ChannelEndPoint.java 104]\r\n  [org.eclipse.jetty.util.thread.QueuedThreadPool runJob QueuedThreadPool.java 773]\r\n  [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner run QueuedThreadPool.java 905]\r\n  [java.lang.Thread run Thread.java 834]]}\r\n17:16:43.461 [qtp1821409160-23] DEBUG crux.query - :query {:find [rule], :where [[rule :juxt.site.alpha/type \"Rule\"]], :in []}\r\n```","state":"open","updated_at":"2022-02-17T12:25:42Z","created_at":"2021-10-08T16:26:01Z","creator_user_login":"admarrs"}
{"number":15,"title":"Add server-timing header to response payloads","body":"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Server-Timing\r\n\r\nnot a huge priority but would be useful for getting performance metrics and doesn't look difficult to implement ","state":"open","updated_at":"2021-10-13T16:44:41Z","created_at":"2021-09-07T13:56:10Z","creator_user_login":"armincerf"}
{"number":10,"title":"[Feature] Add a coerce option for endpoint parameters in openapi.edn","body":"Add a coerce option (or even more generalized transform option) in parameters passed to site endpoints so that they can be used as their proper type/shape from within the Datalog query.\r\n\r\nFor example:\r\n```clojure\r\n{:name \"sort-order\"\r\n :in \"query\"\r\n :description \"The order to sort by\"\r\n :required false\r\n :default \"asc\"\r\n :schema {:type \"string\"}\r\n :coerce keyword}\r\n```\r\nso that i can then use it in my datalog query as:\r\n\r\n```clojure\r\n{:find [(pull e [*]) name]\r\n           :where [[e :juxt.site.alpha/type \"Entity\"]\r\n                        [e :name name]]\r\n           :order-by  [[name {:in \"query\" :name \"sort-order\"}]]}\r\n```","state":"open","updated_at":"2021-10-13T16:45:05Z","created_at":"2021-07-22T13:53:53Z","creator_user_login":"DrBuchkov"}
{"number":5,"title":"Extraneous Input regex.Matcher","body":"I'm getting the following error on some requests, it looks like pattern matching on the accept-content header throwing an exception:\r\n\r\n```\r\nJun  1 01:41:49 ip-172-31-26-211 web: Extraneous input: {:matcher #object[java.util.regex.Matcher 0x58f9dc87 \"java.util.regex.Matcher[pattern=.* region=34,52 lastmatch=*; q=.2, */*; q=.2]\"], :result ({:juxt.reap.alpha.rfc7231/media-range \"text/html\", :juxt.reap.alpha.rfc7231/type \"text\", :juxt.reap.alpha.rfc7231/subtype \"html\", :juxt.reap.alpha.rfc7231/parameters {}} {:juxt.reap.alpha.rfc7231/media-range \"image/gif\", :juxt.reap.alpha.rfc7231/type \"image\", :juxt.reap.alpha.rfc7231/subtype \"gif\", :juxt.reap.alpha.rfc7231/parameters {}} {:juxt.reap.alpha.rfc7231/media-range \"image/jpeg\", :juxt.reap.alpha.rfc7231/type \"image\", :juxt.reap.alpha.rfc7231/subtype \"jpeg\", :juxt.reap.alpha.rfc7231/parameters {}}), :remainder \"*; q=.2, *â€¦\", :crux.db/id nil, :juxt.site.alpha/type \"Request\", :ring.request/headers nil}\r\nJun  1 01:41:49 ip-172-31-26-211 web: clojure.lang.ExceptionInfo: Extraneous input\r\nJun  1 01:41:49 ip-172-31-26-211 web: at juxt.reap.alpha.combinators$complete$fn__6026.invoke(combinators.clj:244)\r\nJun  1 01:41:49 ip-172-31-26-211 web: at juxt.reap.alpha.ring$headers__GT_decoded_preferences$iter__12626__12630$fn__12631$fn__12632.invoke(ring.clj:36)\r\nJun  1 01:41:49 ip-172-31-26-211 web: at juxt.reap.alpha.ring$headers__GT_decoded_preferences$iter__12626__12630$fn__12631.invoke(ring.clj:35)\r\nJun  1 01:41:49 ip-172-31-26-211 web: at clojure.lang.LazySeq.sval(LazySeq.java:42)\r\n```","state":"open","updated_at":"2021-06-01T11:35:14Z","created_at":"2021-06-01T11:35:14Z","creator_user_login":"tggreene"}
